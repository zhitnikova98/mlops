# –°–µ–º–∏–Ω–∞—Ä: –°–æ–∑–¥–∞–Ω–∏–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ–≥–æ ML-–ø—Ä–æ–µ–∫—Ç–∞

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
1. [–¶–µ–ª—å –∏ –∑–∞–¥–∞—á–∏](#—Ü–µ–ª—å-–∏-–∑–∞–¥–∞—á–∏)
2. [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Ä–µ–¥—ã](#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-—Å—Ä–µ–¥—ã)
3. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
4. [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏](#—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏)
5. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
6. [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è](#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-–æ–±—É—á–µ–Ω–∏—è)
7. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
8. [MLflow —Ç—Ä–µ–∫–∏–Ω–≥](#mlflow-—Ç—Ä–µ–∫–∏–Ω–≥)
9. [–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞](#–∫–∞—á–µ—Å—Ç–≤–æ-–∫–æ–¥–∞)
10. [–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è](#–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è)
11. [–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è](#–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è)
12. [–ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏](#–ø–æ–¥–≤–æ–¥–Ω—ã–µ-–∫–∞–º–Ω–∏)

---

## –¶–µ–ª—å –∏ –∑–∞–¥–∞—á–∏

### –ß—Ç–æ –º—ã —Å–æ–∑–¥–∞–µ–º?
–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–π ML-–ø—Ä–æ–µ–∫—Ç —Å:
- –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
- –¢—Ä–µ–∫–∏–Ω–≥–æ–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ (MLflow)
- –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –∫–æ–¥–æ–º (–ª–∏–Ω—Ç–µ—Ä—ã, —Ç–µ—Å—Ç—ã)
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–µ–π
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–µ–π –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

### –ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ?
- **–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å** - –æ—Å–Ω–æ–≤–∞ –Ω–∞—É—á–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –≤ ML
- **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤** - –ø–æ–Ω–∏–º–∞–Ω–∏–µ —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞** - –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - —ç–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏ –∏ —Å–Ω–∏–∂–µ–Ω–∏–µ –æ—à–∏–±–æ–∫

---

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Ä–µ–¥—ã

### –®–∞–≥ 1: Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone https://github.com/tam2511/mlops2025.git
cd mlops2025
git checkout -b lesson1
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- –°–æ–∑–¥–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω—É—é –≤–µ—Ç–∫—É –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã
- –°–ª–µ–¥—É–µ–º Git Flow –¥–ª—è —á–∏—Å—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–∏

**–ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏:**
- –í—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–π—Ç–µ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –≤–µ—Ç–∫–∞—Ö
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ, —á—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≤–µ—Ç–∫–µ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã

### –®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Poetry

```bash
# macOS —Å Homebrew
brew install poetry

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ
curl -sSL https://install.python-poetry.org | python3 -
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
Poetry vs pip:
- **Poetry**: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ + –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ + packaging
- **pip**: —Ç–æ–ª—å–∫–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
- Poetry —Å–æ–∑–¥–∞–µ—Ç `poetry.lock` –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è —Å—Ä–µ–¥—ã

**–ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏:**
- Poetry –º–æ–∂–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å conda/virtualenv
- –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö CI —Å–∏—Å—Ç–µ–º–∞—Ö –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å pip
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `poetry config virtualenvs.in-project true` –¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö .venv

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

```
lesson1/seminar/
‚îú‚îÄ‚îÄ configs/               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ train.yaml
‚îú‚îÄ‚îÄ src/                   # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îÇ   ‚îî‚îÄ‚îÄ app/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ train.py
‚îú‚îÄ‚îÄ tests/                 # –¢–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ test_sanity.py
‚îú‚îÄ‚îÄ data/                  # –î–∞–Ω–Ω—ã–µ (–≤ .gitignore)
‚îÇ   ‚îú‚îÄ‚îÄ raw/
‚îÇ   ‚îî‚îÄ‚îÄ processed/
‚îú‚îÄ‚îÄ models/                # –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (–≤ .gitignore)
‚îú‚îÄ‚îÄ pyproject.toml         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ poetry.lock           # –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏
‚îú‚îÄ‚îÄ Makefile              # –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥
‚îú‚îÄ‚îÄ Dockerfile            # –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ .gitignore            # –ò—Å–∫–ª—é—á–µ–Ω–∏—è Git
‚îú‚îÄ‚îÄ .dockerignore         # –ò—Å–∫–ª—é—á–µ–Ω–∏—è Docker
‚îú‚îÄ‚îÄ .pre-commit-config.yaml # Pre-commit —Ö—É–∫–∏
‚îî‚îÄ‚îÄ README.md             # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:**
- **src/app/** - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **configs/** - –≤—Å–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- **tests/** - —Ç–µ—Å—Ç—ã —Ä—è–¥–æ–º —Å –∫–æ–¥–æ–º, –Ω–æ –æ—Ç–¥–µ–ª—å–Ω–æ
- **data/**, **models/** - –≤ .gitignore, –Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–∑–≤–µ—Å—Ç–Ω–∞

**–ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏:**
- –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ –±–æ–ª—å—à–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ Git
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ .gitkeep –¥–ª—è –ø—É—Å—Ç—ã—Ö –≤–∞–∂–Ω—ã—Ö –ø–∞–ø–æ–∫
- __init__.py –Ω—É–∂–µ–Ω –¥–ª—è –∏–º–ø–æ—Ä—Ç–æ–≤ –≤ Python

---

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

### –®–∞–≥ 4: pyproject.toml

```toml
[tool.poetry]
name = "app"
version = "0.1.0"
description = "Reproducible ML project with MLflow tracking"

[tool.poetry.dependencies]
python = ">=3.11,<3.12"        # –§–∏–∫—Å–∏—Ä—É–µ–º –≤–µ—Ä—Å–∏—é Python
scikit-learn = "1.5"           # –û—Å–Ω–æ–≤–Ω–∞—è ML –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
mlflow = "2.14"                # –¢—Ä–µ–∫–∏–Ω–≥ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
pyyaml = "6.0"                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

[tool.poetry.group.dev.dependencies]
pytest = "7.4"                 # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
ruff = "0.6"                   # –ë—ã—Å—Ç—Ä—ã–π –ª–∏–Ω—Ç–µ—Ä
black = "24.4"                 # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
mypy = "1.8"                   # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤
pre-commit = "3.7"             # Git —Ö—É–∫–∏
setuptools = "^80.9.0"         # –î–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å MLflow
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞ –≤–µ—Ä—Å–∏–π:**
- **–¢–æ—á–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –¥–ª—è prod –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** - –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å
- **–ì–∏–±–∫–∏–µ –≤–µ—Ä—Å–∏–∏ –¥–ª—è dev –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤** - –ø–æ–ª—É—á–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **Python 3.11** - –±–∞–ª–∞–Ω—Å –Ω–æ–≤–∏–∑–Ω—ã –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏

**–ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏:**
- MLflow —Ç—Ä–µ–±—É–µ—Ç setuptools (pkg_resources deprecation)
- –°–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–∏–µ –≤–µ—Ä—Å–∏–∏ ‚Üí —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏
- –°–ª–∏—à–∫–æ–º –º—è–≥–∫–∏–µ –≤–µ—Ä—Å–∏–∏ ‚Üí —Ä–∞–∑–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Ä–∞–∑–Ω—ã—Ö —Å—Ä–µ–¥–∞—Ö

### –®–∞–≥ 5: poetry.lock

```bash
poetry install  # –°–æ–∑–¥–∞–µ—Ç poetry.lock –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `poetry.lock` - —Ç–æ—á–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤–∫–ª—é—á–∞—è —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω—ã–µ
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–∞ –≤—Å–µ—Ö –º–∞—à–∏–Ω–∞—Ö
- –ê–Ω–∞–ª–æ–≥ `package-lock.json` –≤ Node.js

**–ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏:**
- –í—Å–µ–≥–¥–∞ –∫–æ–º–º–∏—Ç—å—Ç–µ poetry.lock
- –ü—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞—Ö - —É–¥–∞–ª–∏—Ç–µ lock –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ
- poetry.lock –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –¥–ª—è –≤–∞—à–µ–π –û–° - –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –¥—Ä—É–≥–∏—Ö

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –®–∞–≥ 6: train.yaml

```yaml
seed: 42                    # –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π seed –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏
test_size: 0.2              # –†–∞–∑–º–µ—Ä —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏
model:                      # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏
  C: 1.0                    # –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è
  max_iter: 200             # –ú–∞–∫—Å–∏–º—É–º –∏—Ç–µ—Ä–∞—Ü–∏–π
mlflow_experiment: "lesson1-baseline"  # –ù–∞–∑–≤–∞–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- **YAML vs JSON** - —É–¥–æ–±–Ω–µ–µ –¥–ª—è –ª—é–¥–µ–π, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- **–í–Ω–µ—à–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–∏** - –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –±–µ–∑ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å** - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ª–æ–≥–∏—á–µ—Å–∫–∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**–ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏:**
- YAML —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –æ—Ç—Å—Ç—É–ø–∞–º
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–∞–±—ã, —Ç–æ–ª—å–∫–æ –ø—Ä–æ–±–µ–ª—ã
- –û—Å—Ç–æ—Ä–æ–∂–Ω–æ —Å —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö (—Å—Ç—Ä–æ–∫–∏ vs —á–∏—Å–ª–∞)

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```python
# Hydra (–¥–ª—è –±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤)
from hydra import compose, initialize

# Pydantic Settings (–¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏)
from pydantic import BaseSettings

# Argparse (–¥–ª—è CLI)
import argparse
```

---

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è

### –®–∞–≥ 7: –ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ train.py

```python
def set_seed(seed: int) -> None:
    """–§–∏–∫—Å–∏—Ä—É–µ–º –≤—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏."""
    random.seed(seed)
    np.random.seed(seed)
    # sklearn –∏—Å–ø–æ–ª—å–∑—É–µ—Ç numpy.random

def load_config(config_path: str = "configs/train.yaml") -> Dict[str, Any]:
    """–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏."""
    with open(config_path, "r") as f:
        return yaml.safe_load(f)

def prepare_data(test_size: float, random_state: int) -> Tuple[...]:
    """–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º split."""
    # –í–∞–∂–Ω–æ: stratify=y –¥–ª—è —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–±–∏–µ–Ω–∏—è
    return train_test_split(..., stratify=y, random_state=random_state)
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:**
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥** - –ª–µ–≥—á–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
- **–¢–∏–ø–∏–∑–∞—Ü–∏—è** - mypy –ø–æ–π–º–∞–µ—Ç –æ—à–∏–±–∫–∏ –Ω–∞ —Ä–∞–Ω–Ω–µ–º —ç—Ç–∞–ø–µ
- **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** - –∫–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–µ–ª–∞–µ—Ç –æ–¥–Ω—É –≤–µ—â—å

**–ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º–∞:**
- Sklearn –Ω–µ –≤—Å–µ–≥–¥–∞ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω (–æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –û–°)
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–µ –≤—Ä–µ–º—è
- –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å –º–æ–∂–µ—Ç –Ω–∞—Ä—É—à–∏—Ç—å –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º
- GPU –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —á–∞—Å—Ç–æ –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω—ã

### –®–∞–≥ 8: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```python
def main() -> None:
    try:
        config = load_config()
    except FileNotFoundError:
        print("Config file not found!")
        sys.exit(1)
    except yaml.YAMLError as e:
        print(f"Invalid YAML: {e}")
        sys.exit(1)
```

**–ó–∞—á–µ–º –Ω—É–∂–Ω–æ:**
- –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –®–∞–≥ 9: –¢–µ—Å—Ç—ã –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö

```python
def test_accuracy_threshold():
    """Smoke test - –ø—Ä–æ–≤–µ—Ä—è–µ–º –∞–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏."""
    # Iris - –ø—Ä–æ—Å—Ç–∞—è –∑–∞–¥–∞—á–∞, accuracy –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤—ã—Å–æ–∫–æ–π
    assert metrics["accuracy"] >= 0.85

def test_determinism():
    """–ö–ª—é—á–µ–≤–æ–π —Ç–µ—Å—Ç - –¥–≤–∞ –∑–∞–ø—É—Å–∫–∞ = –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç."""
    accuracy1 = run_training_pipeline()
    accuracy2 = run_training_pipeline()
    assert abs(accuracy1 - accuracy2) <= 0.001

def test_data_split_determinism():
    """–ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º –Ω–∞ —É—Ä–æ–≤–Ω–µ –¥–∞–Ω–Ω—ã—Ö."""
    # –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ random_state = –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ splits
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ —Ç–µ—Å—Ç–æ–≤:**
- **Smoke tests** - "–Ω–µ –ø–∞–¥–∞–µ—Ç –ª–∏ –≤—Å–µ"
- **Property tests** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å–≤–æ–π—Å—Ç–≤
- **Integration tests** - —Ä–∞–±–æ—Ç–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤–º–µ—Å—Ç–µ
- **Determinism tests** - —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ –¥–ª—è ML

**–ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è ML:**
- –¢–µ—Å—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º–∏ –∏–∑-–∑–∞ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏
- –ù–µ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ç–æ—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ (–æ–Ω–∏ –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å—Å—è)
- –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å–≤–æ–π—Å—Ç–≤–∞: accuracy > baseline, –º–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è –∏ —Ç.–¥.

### –®–∞–≥ 10: –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
poetry run pytest -v       # –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥
poetry run pytest -x       # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–µ
poetry run pytest --tb=short  # –ö–æ—Ä–æ—Ç–∫–∏–π traceback
```

---

## MLflow —Ç—Ä–µ–∫–∏–Ω–≥

### –®–∞–≥ 11: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ MLflow

```python
# –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ (–Ω–µ –∑–∞—Å–æ—Ä—è–µ–º –æ–±—â–∏–µ –ø–∞–ø–∫–∏)
mlflow.set_tracking_uri("file:./mlruns")

# –°–æ–∑–¥–∞–Ω–∏–µ/–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞
mlflow.set_experiment("lesson1-baseline")

with mlflow.start_run():
    # –õ–æ–≥–∏—Ä—É–µ–º –í–°–ï –≤–∞–∂–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    mlflow.log_param("seed", seed)
    mlflow.log_param("test_size", test_size)

    # –ú–µ—Ç—Ä–∏–∫–∏
    mlflow.log_metric("accuracy", accuracy)

    # –ú–æ–¥–µ–ª—å –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
    mlflow.sklearn.log_model(model, "model")

    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–∞–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç
    mlflow.log_artifact("configs/train.yaml")
```

**–ß—Ç–æ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤ MLflow:**
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: –≤—Å—ë —á—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- **–ú–µ—Ç—Ä–∏–∫–∏**: –≤—Å—ë —á—Ç–æ –∏–∑–º–µ—Ä—è–µ–º
- **–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã**: –º–æ–¥–µ–ª–∏, –∫–æ–Ω—Ñ–∏–≥–∏, –≤–∞–∂–Ω—ã–µ —Ñ–∞–π–ª—ã
- **–¢–µ–≥–∏**: –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –∏ –ø–æ–∏—Å–∫–∞

**–ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏ MLflow:**
- –ë–æ–ª—å—à–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å—ä–µ–¥–∞—é—Ç –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ
- MLflow UI –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
- –ù–µ –ª–æ–≥–∏—Ä—É–π—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- file:// URI –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã MLflow

- **Weights & Biases (wandb)** - –ª—É—á—à–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
- **TensorBoard** - –¥–ª—è TensorFlow/PyTorch
- **Neptune** - –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
- **ClearML** - –ø–æ–ª–Ω—ã–π MLOps stack

---

## –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞

### –®–∞–≥ 12: –õ–∏–Ω—Ç–µ—Ä—ã –∏ —Ñ–æ—Ä–º–∞—Ç–µ—Ä—ã

```bash
# Ruff - –±—ã—Å—Ç—Ä–∞—è –∑–∞–º–µ–Ω–∞ flake8, isort, –∏ –¥—Ä.
poetry run ruff check .
poetry run ruff check . --fix  # –ê–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

# Black - –±–µ—Å–∫–æ–º–ø—Ä–æ–º–∏—Å—Å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç–µ—Ä
poetry run black .
poetry run black --check .     # –¢–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–∫–∞

# MyPy - —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤
poetry run mypy src/
```

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ pyproject.toml:**
```toml
[tool.ruff.lint]
select = ["E", "F", "W", "C90"]  # –ö–∞–∫–∏–µ –æ—à–∏–±–∫–∏ –∏—Å–∫–∞—Ç—å

[tool.black]
line-length = 88                # –°—Ç–∞–Ω–¥–∞—Ä—Ç —á–µ—Ä–Ω–æ–≥–æ

[tool.mypy]
disallow_untyped_defs = true    # –¢—Ä–µ–±–æ–≤–∞—Ç—å —Ç–∏–ø–∏–∑–∞—Ü–∏—é
```

**–ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏:**
- –ù–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ —Å–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–æ —Å—Ä–∞–∑—É
- Black –º–æ–∂–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å –¥—Ä—É–≥–∏–º–∏ —Ñ–æ—Ä–º–∞—Ç–µ—Ä–∞–º–∏
- MyPy —Ç—Ä–µ–±—É–µ—Ç —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ - –¥–æ–±–∞–≤–ª—è–π—Ç–µ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ

### –®–∞–≥ 13: Pre-commit —Ö—É–∫–∏

```yaml
repos:
  - repo: https://github.com/psf/black
    hooks:
      - id: black

  - repo: https://github.com/astral-sh/ruff-pre-commit
    hooks:
      - id: ruff
        args: [--fix]

  - repo: https://github.com/pre-commit/pre-commit-hooks
    hooks:
      - id: end-of-file-fixer
      - id: check-yaml
      - id: trailing-whitespace
```

```bash
poetry run pre-commit install      # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ö—É–∫–æ–≤
poetry run pre-commit run --all-files  # –ó–∞–ø—É—Å–∫ –Ω–∞ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö
```

**–ó–∞—á–µ–º pre-commit:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–π –∫–æ–¥ –≤ –∫–æ–º–∞–Ω–¥–µ
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ "–≥—Ä—è–∑–Ω—ã—Ö" –∫–æ–º–º–∏—Ç–æ–≤

---

## –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è

### –®–∞–≥ 14: Dockerfile

```dockerfile
FROM python:3.11-slim

ENV PYTHONUNBUFFERED=1          # –ù–µ –±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥
ENV MLFLOW_TRACKING_URI=file:./mlruns

WORKDIR /app

# –°–Ω–∞—á–∞–ª–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ–µ–≤)
RUN pip install poetry==1.8.3
RUN poetry config virtualenvs.create false

COPY pyproject.toml poetry.lock ./
RUN poetry install --no-interaction --no-ansi

# –ü–æ—Ç–æ–º –∫–æ–¥
COPY src src
COPY configs configs

CMD ["python", "-m", "src.app.train"]
```

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ Docker:**
- **Multi-stage builds** –¥–ª—è –º–µ–Ω—å—à–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
- **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ–µ–≤** - –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–Ω—è—é—Ç—Å—è —Ä–µ–∂–µ –∫–æ–¥–∞
- **–°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ç–µ–≥–∏** –≤–º–µ—Å—Ç–æ latest
- **.dockerignore** –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –Ω–µ–Ω—É–∂–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

**–ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏ Docker:**
- poetry.lock –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –¥—Ä—É–≥–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ
- –†–∞–∑–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –û–° –¥–∞–∂–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö
- –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ volumes –¥–ª—è MLflow –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤

### –®–∞–≥ 15: .dockerignore

```
.venv/
.git/
mlruns/        # –ë—É–¥–µ–º –º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ volume
data/          # –ë–æ–ª—å—à–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
.pytest_cache/
__pycache__/
```

---

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

### –®–∞–≥ 16: Makefile

```makefile
.PHONY: install lint test train mlflow-ui docker-build docker-run

install:
	poetry install

lint:
	poetry run ruff check .
	poetry run black --check .

test:
	poetry run pytest -q

train:
	poetry run python -m src.app.train

mlflow-ui:
	poetry run mlflow ui --backend-store-uri ./mlruns

docker-build:
	docker build -t lesson1-mlops:0.1 .

docker-run:
	docker run --rm -v "$(PWD)/mlruns:/app/mlruns" lesson1-mlops:0.1
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã Makefile:**
- **Just** - –±–æ–ª–µ–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π make
- **Task** (Go) - –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π
- **npm scripts** - –µ—Å–ª–∏ —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Node.js
- **Poetry scripts** –≤ pyproject.toml

---

## –ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏

### –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
1. **–†–∞–∑–Ω—ã–µ –û–°** ‚Üí —Ä–∞–∑–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–∞–∂–µ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ seeds
2. **–ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å** ‚Üí race conditions –≤ —Ä–∞–Ω–¥–æ–º–µ
3. **GPU** ‚Üí –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
4. **–°–∏—Å—Ç–µ–º–Ω–æ–µ –≤—Ä–µ–º—è** ‚Üí –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã

**–†–µ—à–µ–Ω–∏—è:**
- –§–∏–∫—Å–∏—Ä—É–π—Ç–µ –í–°–ï –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Ä–∞–Ω–¥–æ–º–∞
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `stratify` –≤ train_test_split
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –≤–µ—Ä—Å–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫
- –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### MLflow –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

**üî• –ü—Ä–æ–±–ª–µ–º—ã:**
- File storage –Ω–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è
- UI –ø–∞–¥–∞–µ—Ç –Ω–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö –¥–∞–Ω–Ω—ã—Ö
- –ù–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –°–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å –æ—á–∏—Å—Ç–∫–æ–π —Å—Ç–∞—Ä—ã—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

**–†–µ—à–µ–Ω–∏—è:**
- S3/GCS –¥–ª—è artifact store
- PostgreSQL –¥–ª—è metadata store
- –†–µ–≥—É–ª—è—Ä–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã: wandb, neptune

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

**üî• –ü—Ä–æ–±–ª–µ–º—ã:**
- –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤–µ—Ä—Å–∏–π
- Security vulnerabilities –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö
- –†–∞–∑–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å "–≥–∏–±–∫–∏–º–∏" –≤–µ—Ä—Å–∏—è–º–∏
- –ú–µ–¥–ª–µ–Ω–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–∞–∫–µ—Ç–æ–≤

**–†–µ—à–µ–Ω–∏—è:**
- –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- Dependabot –¥–ª—è –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- –¢–æ—á–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –°–ª–æ–∏ Docker –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ML –∫–æ–¥–∞

**üî• –ü—Ä–æ–±–ª–µ–º—ã:**
- –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –∏–∑-–∑–∞ —Ä–∞–Ω–¥–æ–º–∞
- –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏
- –î–æ–ª–≥–∏–µ —Ç–µ—Å—Ç—ã –æ–±—É—á–µ–Ω–∏—è
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏—è:**
- –ú–æ–∫–∞–π—Ç–µ —Ç—è–∂–µ–ª—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- Smoke tests –≤–º–µ—Å—Ç–æ —Ç–æ—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- Property-based —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å:

1. **CI/CD Pipeline**
   - GitHub Actions –¥–ª—è –∞–≤—Ç–æ—Ç–µ—Å—Ç–æ–≤
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –≤ staging
   - Matrix builds –Ω–∞ —Ä–∞–∑–Ω—ã—Ö Python –≤–µ—Ä—Å–∏—è—Ö

2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ (JSON)
   - –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
   - –ê–ª–µ—Ä—Ç—ã –Ω–∞ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—é –º–æ–¥–µ–ª–∏

3. **Data Pipeline**
   - DVC –¥–ª—è –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
   - Feature store

4. **Model Serving**
   - REST API —Å FastAPI
   - Model registry
   - A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

5. **Scalability**
   - Kubernetes –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏
   - Apache Airflow –¥–ª—è –ø–∞–π–ø–ª–∞–π–Ω–æ–≤
   - Distributed training

---

## –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### –ö–Ω–∏–≥–∏
- "Designing Machine Learning Systems" - Chip Huyen
- "Building Machine Learning Pipelines" - Hannes Hapke
- "ML Engineering" - Andriy Burkov

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- **MLflow** - experiment tracking
- **DVC** - data versioning
- **Great Expectations** - data validation
- **Evidently** - ML monitoring
- **BentoML** - model serving

### Best Practices
- [Google's Rules of Machine Learning](https://developers.google.com/machine-learning/guides/rules-of-ml)
- [ML Test Score Rubric](https://storage.googleapis.com/pub-tools-public-publication-data/pdf/aad9f93b86b7addfea4c419b9100c6cdd26cacea.pdf)
- [Hidden Technical Debt in ML Systems](https://papers.nips.cc/paper/2015/file/86df7dcfd896fcaf2674f757a2463eba-Paper.pdf)

---

**–ì–ª–∞–≤–Ω—ã–π —Å–æ–≤–µ—Ç:** –ù–∞—á–∏–Ω–∞–π—Ç–µ –ø—Ä–æ—Å—Ç–æ, –¥–æ–±–∞–≤–ª—è–π—Ç–µ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ. –õ—É—á—à–µ —Ä–∞–±–æ—Ç–∞—é—â–∏–π –ø—Ä–æ—Å—Ç–æ–π –ø–∞–π–ø–ª–∞–π–Ω, —á–µ–º —Å–ª–æ–º–∞–Ω–Ω—ã–π —Å–ª–æ–∂–Ω—ã–π!

# Lesson 6: LLMOps - Animation Generation with RAG

## ะะฟะธัะฐะฝะธะต

ะฃัะพะบ ะฟะพัะฒััะตะฝ **LLMOps** ะธ ัะพะทะดะฐะฝะธั **ะฐะฝะธะผะฐัะธะน ะดะตะนััะฒะธะน ัะตะปะพะฒะตะบะฐ** ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ:
- **LLM** (Large Language Model) ะดะปั ะณะตะฝะตัะฐัะธะธ
- **Function Calling** ะดะปั ะฒะทะฐะธะผะพะดะตะนััะฒะธั ั API
- **RAG** (Retrieval-Augmented Generation) ะดะปั ัะปัััะตะฝะธั ะบะฐัะตััะฒะฐ

## ะกัััะบัััะฐ

### Step 1: Ollama Inference
ะะฐะทะพะฒัะน LLM ัะตัะฒะธั ั OpenAI-ัะพะฒะผะตััะธะผัะผ API:
- Ollama ะดะปั ะธะฝัะตัะตะฝัะฐ
- qwen2.5:1.5b (ะบะฒะฐะฝัะพะฒะฐะฝะฝะฐั GGUF ~1GB)
- OpenAI SDK ะบะปะธะตะฝั
- Jupyter notebook ะดะปั ะดะตะผะพะฝัััะฐัะธะธ

### Step 2: Function Calling
ะะตะฝะตัะฐัะธั ะฐะฝะธะผะฐัะธะน ัะตัะตะท function calling:
- Pose Visualization API (FastAPI)
- LLM Agent ั function calling
- ะกะพะทะดะฐะฝะธะต GIF ะธะท ะฟะพัะปะตะดะพะฒะฐัะตะปัะฝะพััะธ ะฟะพะท
- **ะัะพะฑะปะตะผะฐ**: ะผะฐะปะตะฝัะบะฐั ะผะพะดะตะปั ะดะตะปะฐะตั ะพัะธะฑะบะธ ะฒ ะบะพะพัะดะธะฝะฐัะฐั

### Step 3: RAG (Retrieval-Augmented Generation)
ะฃะปัััะตะฝะธะต ะบะฐัะตััะฒะฐ ัะตัะตะท RAG:
- ะะฐะทะฐ ะดะฐะฝะฝัั ั 75 ะฟัะพะฒะตัะตะฝะฝัะผะธ ะฟะพะทะฐะผะธ
- TF-IDF ะฟะพะธัะบ ะฟะพ ะพะฟะธัะฐะฝะธัะผ
- LLM ะณะตะฝะตัะธััะตั ะพะฟะธัะฐะฝะธั โ RAG ะฝะฐัะพะดะธั ะฟะพะทั
- **ะะตะทัะปััะฐั**: ะฒัะตะณะดะฐ ะบะพััะตะบัะฝัะต ะบะพะพัะดะธะฝะฐัั
- **ะะตะผะพ**: ัะฐะฝะตั ะะฐะบะฐัะตะฝะฐ (12 ะบะฐะดัะพะฒ)

## ะัะฝะพะฒะฝะฐั ะธะดะตั

### ะะตะท RAG (Step 2):
```
LLM โ JSON ะบะพะพัะดะธะฝะฐัั โ Pose API โ GIF
โ ะัะธะฑะบะธ ะฒ ะบะพะพัะดะธะฝะฐัะฐั
โ ะัะถะฝะฐ ะฑะพะปััะฐั ะผะพะดะตะปั
```

### ะก RAG (Step 3):
```
LLM โ ะะฟะธัะฐะฝะธั โ RAG โ ะัะพะฒะตัะตะฝะฝัะต ะฟะพะทั โ GIF
โ ะัะตะณะดะฐ ะบะพััะตะบัะฝัะต ะบะพะพัะดะธะฝะฐัั
โ ะะฐะฑะพัะฐะตั ั ะผะฐะปะตะฝัะบะพะน ะผะพะดะตะปัั
โ ะะตะณะบะพ ัะฐััะธัััั ะฑะฐะทั
```

## ะัััััะน ััะฐัั

### 1. ะะฐะฟััะบ ัะตัะฒะธัะพะฒ (Step 2 ะธะปะธ Step 3)

```bash
cd lesson6/seminar/step2_function_calling
make start-all    # Ollama + Pose API
make pull         # ะะฐะณััะทะบะฐ ะผะพะดะตะปะธ ~1GB
```

### 2. Step 2: Function Calling (ะฑะฐะทะพะฒัะน)

```bash
cd lesson6/seminar/step2_function_calling
poetry install
poetry run python test_scripts/demo_animation.py
```

### 3. Step 3: RAG ะะฐะบะฐัะตะฝะฐ ๐ฌ

```bash
cd lesson6/seminar/step3_rag
poetry install
poetry run python demo_macarena_direct.py
open output/macarena.gif
```

## ะะตะผะพะฝัััะฐัะธั

### ะะฐะบะฐัะตะฝะฐ (12 ะบะฐะดัะพะฒ, ะทะฐัะธะบะปะตะฝะฝะฐั)

RAG ัะธััะตะผะฐ:
1. ะะพะปััะฐะตั ะพะฟะธัะฐะฝะธั ะดะฒะธะถะตะฝะธะน ะะฐะบะฐัะตะฝั
2. ะะฐัะพะดะธั ะฟะพัะพะถะธะต ะฟะพะทั ะธะท ะฑะฐะทั (TF-IDF similarity)
3. ะะตะฝะตัะธััะตั 12 ะบะฐะดัะพะฒ
4. ะกะพะทะดะฐะตั ะทะฐัะธะบะปะตะฝะฝัะน GIF

```
๐ Searching for 12 poses...
  1. ััะบะธ ะฒะฟะตัะตะด ะฝะฐ ััะพะฒะฝะต ะฟะปะตั... (sim: 0.72)
  2. ะฟัะฐะฒะฐั ััะบะฐ ะฒะฒะตัั ะปะตะฒะฐั ะฒะฟะตัะตะด... (sim: 0.58)
  ...
๐ฌ Creating GIF...
โ Saved: output/macarena.gif
```

## ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโ
โ  User Request   โ  "ะกะพะทะดะฐะน ัะฐะฝะตั ะผะฐะบะฐัะตะฝะฐ"
โโโโโโโโโโฌโโโโโโโโโ
         โ
โโโโโโโโโโโโโโโโโโโ
โ   LLM (Ollama)  โ  ะะตะฝะตัะธััะตั ะพะฟะธัะฐะฝะธั ะดะฒะธะถะตะฝะธะน
โโโโโโโโโโฌโโโโโโโโโ
         โ
โโโโโโโโโโโโโโโโโโโ
โ  RAG Retriever  โ  TF-IDF ะฟะพะธัะบ ะฒ ะฑะฐะทะต (75 ะฟะพะท)
โโโโโโโโโโฌโโโโโโโโโ
         โ
โโโโโโโโโโโโโโโโโโโ
โ   Pose API      โ  ะะธะทัะฐะปะธะทะฐัะธั ะฟะพะท (FastAPI)
โโโโโโโโโโฌโโโโโโโโโ
         โ
โโโโโโโโโโโโโโโโโโโ
โ  GIF Generator  โ  ะกะพะทะดะฐะฝะธะต ะฐะฝะธะผะฐัะธะธ (Pillow)
โโโโโโโโโโฌโโโโโโโโโ
         โ
    macarena.gif ๐ฌ
```

## ะขะตัะฝะพะปะพะณะธะธ

- **Ollama**: LLM inference ะฝะฐ CPU
- **qwen2.5:1.5b**: ะะฒะฐะฝัะพะฒะฐะฝะฝะฐั ะผะพะดะตะปั (GGUF)
- **FastAPI**: Pose Visualization API
- **scikit-learn**: TF-IDF ะดะปั RAG
- **Pillow**: ะกะพะทะดะฐะฝะธะต GIF
- **Matplotlib**: ะะธัะพะฒะฐะฝะธะต ัะตะปะพะฒะตัะบะพะฒ

## ะกัะฐะฒะฝะตะฝะธะต ะฟะพะดัะพะดะพะฒ

| ะัะธัะตัะธะน | Function Calling | RAG |
|----------|-----------------|-----|
| ะะฐัะตััะฒะพ ะบะพะพัะดะธะฝะฐั | โ๏ธ ะะฐะฒะธัะธั ะพั ะผะพะดะตะปะธ | โ ะัะตะณะดะฐ ะบะพััะตะบัะฝะพ |
| ะกะบะพัะพััั | ๐ ะะตะดะปะตะฝะฝะพ | โก ะััััะพ |
| ะะฐะดะตะถะฝะพััั | โ๏ธ ะะตััะฐะฑะธะปัะฝะพ | โ ะกัะฐะฑะธะปัะฝะพ |
| ะขัะตะฑะพะฒะฐะฝะธั ะบ LLM | ๐ด ะัะถะฝะฐ ะฑะพะปััะฐั ะผะพะดะตะปั | ๐ข ะัะฑะฐั ะผะพะดะตะปั |
| ะะฐััะธััะตะผะพััั | โ๏ธ ะัะถะฝั ะฟัะธะผะตัั | โ ะัะพััะพ ะดะพะฑะฐะฒะธัั ะฟะพะทั |

## ะะตะทัะปััะฐัั

- โ 3 ัะฐะณะฐ ั ะฟัะพะณัะตััะธะฒะฝัะผ ัะปัััะตะฝะธะตะผ
- โ ะะฐะบะฐัะตะฝะฐ: 12 ะบะฐะดัะพะฒ, ะทะฐัะธะบะปะตะฝะฝะฐั
- โ 75 ะฟะพะท ะฒ ะฑะฐะทะต ะดะฐะฝะฝัั
- โ RAG ะฟะพะบะฐะทัะฒะฐะตั ะฟัะตะธะผััะตััะฒะพ ะฝะฐะด function calling
- โ ะะฐะฑะพัะฐะตั ะฝะฐ CPU (ะฑะตะท GPU)

## ะะฑััะฐััะธะต ะผะฐัะตัะธะฐะปั

ะะฐะถะดัะน step ัะพะดะตัะถะธั:
- `README.md` - ะดะพะบัะผะตะฝัะฐัะธั
- `Makefile` - ะบะพะผะฐะฝะดั ะดะปั ะทะฐะฟััะบะฐ
- `notebooks/` - Jupyter ะดะตะผะพะฝัััะฐัะธะธ
- `test_scripts/` - ัะตััะพะฒัะต ัะบัะธะฟัั
- `src/` - ะธััะพะดะฝัะน ะบะพะด

## ะขัะตะฑะพะฒะฐะฝะธั

- Docker + Colima (ะดะปั Ollama)
- Python 3.10+
- Poetry (ะดะปั ัะฟัะฐะฒะปะตะฝะธั ะทะฐะฒะธัะธะผะพัััะผะธ)
- ~1GB ะดะปั ะผะพะดะตะปะธ
- ~2GB RAM

## ะกะปะตะดัััะธะต ัะฐะณะธ

1. ะะฐััะธัะธัั ะฑะฐะทั ะฟะพะท ะดะพ 150-200
2. ะะพะฑะฐะฒะธัั ะฑะพะปััะต ะดะตะนััะฒะธะน (ะฟัะธะฒะตัััะฒะธะต, ัะฟัะฐะถะฝะตะฝะธั)
3. ะัะฟะพะปัะทะพะฒะฐัั embedding ะผะพะดะตะปะธ ะดะปั better RAG
4. ะะพะฑะฐะฒะธัั ะธะฝัะตัะฟะพะปััะธั ะผะตะถะดั ะบะฐะดัะฐะผะธ
5. ะะพะดะดะตัะถะบะฐ ะฒะธะดะตะพ (MP4) ะฒะผะตััะพ GIF

## ะัะฒะพะดั

- **Function calling** ัะฐะฑะพัะฐะตั, ะฝะพ ะฝะต ะฒัะตะณะดะฐ ะฝะฐะดะตะถะฝะพ ั ะผะฐะปะตะฝัะบะธะผะธ ะผะพะดะตะปัะผะธ
- **RAG** ะทะฝะฐัะธัะตะปัะฝะพ ัะปัััะฐะตั ะบะฐัะตััะฒะพ ะธ ะฝะฐะดะตะถะฝะพััั
- **Verified database** ะฒะฐะถะฝะตะต ัะตะผ ัะปะพะถะฝะฐั ะณะตะฝะตัะฐัะธั
- **Small models** + **RAG** = ัะพัะพัะธะต ัะตะทัะปััะฐัั
